(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{"3/yS":function(l,n,t){"use strict";t.r(n);var u=t("8Y7J");class o{}var i=t("pMnS"),a=t("MKJQ"),e=t("sZkV"),s=t("SVse"),c=t("gcOT"),b=t("QqCr"),r=t("lJxs");class p{constructor(l,n){this.fbAuth=l,this.afs=n,this.markers=[],this.isTracking=!1,this.user=null,this.anonymousLogin()}ionViewWillEnter(){this.watchPosition().subscribe(l=>this.position=l),this.loadMap()}watchPosition(){return Object(b.a)(c.g.watchPosition)({})}showAlert(){c.h.Modals.alert({title:"Your Location",message:"Lat: ".concat(this.position.coords.latitude,", Lng: ").concat(this.position.coords.longitude)})}anonymousLogin(){this.fbAuth.auth.signInAnonymously().then(l=>{this.user=l.user,this.locationsCollection=this.afs.collection("locations/".concat(this.user.uid,"/track"),l=>l.orderBy("timestamp")),this.locations=this.locationsCollection.snapshotChanges().pipe(Object(r.a)(l=>l.map(l=>{const n=l.payload.doc.data();return Object.assign({id:l.payload.doc.id},n)}))),this.locations.subscribe(l=>{this.updateMap(l)})})}loadMap(){const l={center:new google.maps.LatLng(51.9036442,7.6673267),zoom:5,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.mapElement.nativeElement,l)}startTracking(){this.isTracking=!0,this.watch=c.g.watchPosition({},(l,n)=>{l&&this.addNewLocation(l.coords.latitude,l.coords.longitude,l.timestamp)})}stopTracking(){c.g.clearWatch({id:this.watch}).then(()=>{this.isTracking=!1})}addNewLocation(l,n,t){this.locationsCollection.add({lat:l,lng:n,timestamp:t});const u=new google.maps.LatLng(l,n);this.map.setCenter(u),this.map.setZoom(5)}deleteLocation(l){this.locationsCollection.doc(l.id).delete()}updateMap(l){this.markers.map(l=>l.setMap(null)),this.markers=[];for(const n of l){const l=new google.maps.LatLng(n.lat,n.lng),t=new google.maps.Marker({map:this.map,animation:google.maps.Animation.DROP,position:l});this.markers.push(t)}}}var h=t("irV9"),m=t("Xr7G"),d=u.ob({encapsulation:0,styles:[["#map[_ngcontent-%COMP%]{width:100%;height:400px}"]],data:{}});function g(l){return u.Kb(0,[(l()(),u.qb(0,0,null,null,4,"ion-button",[["expand","block"]],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.startTracking()&&u),u}),a.B,a.b)),u.pb(1,49152,null,0,e.i,[u.h,u.k,u.x],{expand:[0,"expand"]},null),(l()(),u.qb(2,0,null,0,1,"ion-icon",[["name","locate"],["slot","start"]],null,null,null,a.J,a.j)),u.pb(3,49152,null,0,e.A,[u.h,u.k,u.x],{name:[0,"name"]},null),(l()(),u.Ib(-1,0,[" Start Tracking "]))],(function(l,n){l(n,1,0,"block"),l(n,3,0,"locate")}),null)}function k(l){return u.Kb(0,[(l()(),u.qb(0,0,null,null,4,"ion-button",[["expand","block"]],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.stopTracking()&&u),u}),a.B,a.b)),u.pb(1,49152,null,0,e.i,[u.h,u.k,u.x],{expand:[0,"expand"]},null),(l()(),u.qb(2,0,null,0,1,"ion-icon",[["name","hand"],["slot","start"]],null,null,null,a.J,a.j)),u.pb(3,49152,null,0,e.A,[u.h,u.k,u.x],{name:[0,"name"]},null),(l()(),u.Ib(-1,0,[" Stop Tracking "]))],(function(l,n){l(n,1,0,"block"),l(n,3,0,"hand")}),null)}function f(l){return u.Kb(0,[(l()(),u.qb(0,0,null,null,15,"ion-item-sliding",[],null,null,null,a.N,a.o)),u.pb(1,49152,null,0,e.K,[u.h,u.k,u.x],null,null),(l()(),u.qb(2,0,null,0,7,"ion-item",[],null,null,null,a.O,a.l)),u.pb(3,49152,null,0,e.F,[u.h,u.k,u.x],null,null),(l()(),u.qb(4,0,null,0,5,"ion-label",[["text-wrap",""]],null,null,null,a.P,a.p)),u.pb(5,49152,null,0,e.L,[u.h,u.k,u.x],null,null),(l()(),u.Ib(6,0,[" Lat: "," Lng: "," "])),(l()(),u.qb(7,0,null,0,2,"p",[],null,null,null,null,null)),(l()(),u.Ib(8,null,[" "," "])),u.Fb(9,2),(l()(),u.qb(10,0,null,0,5,"ion-item-options",[["side","start"]],null,null,null,a.M,a.n)),u.pb(11,49152,null,0,e.J,[u.h,u.k,u.x],{side:[0,"side"]},null),(l()(),u.qb(12,0,null,0,3,"ion-item-option",[["color","danger"]],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.deleteLocation(l.context.$implicit)&&u),u}),a.L,a.m)),u.pb(13,49152,null,0,e.I,[u.h,u.k,u.x],{color:[0,"color"]},null),(l()(),u.qb(14,0,null,0,1,"ion-icon",[["name","trash"],["slot","icon-only"]],null,null,null,a.J,a.j)),u.pb(15,49152,null,0,e.A,[u.h,u.k,u.x],{name:[0,"name"]},null)],(function(l,n){l(n,11,0,"start"),l(n,13,0,"danger"),l(n,15,0,"trash")}),(function(l,n){l(n,6,0,n.context.$implicit.lat,n.context.$implicit.lng);var t=u.Jb(n,8,0,l(n,9,0,u.Cb(n.parent.parent,0),n.context.$implicit.timestamp,"short"));l(n,8,0,t)}))}function x(l){return u.Kb(0,[(l()(),u.qb(0,0,null,null,14,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,4,"ion-item",[],null,null,null,a.O,a.l)),u.pb(2,49152,null,0,e.F,[u.h,u.k,u.x],null,null),(l()(),u.qb(3,0,null,0,2,"ion-label",[],null,null,null,a.P,a.p)),u.pb(4,49152,null,0,e.L,[u.h,u.k,u.x],null,null),(l()(),u.Ib(5,0,["User ID: ",""])),(l()(),u.fb(16777216,null,null,1,null,g)),u.pb(7,16384,null,0,s.k,[u.N,u.J],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,k)),u.pb(9,16384,null,0,s.k,[u.N,u.J],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(10,0,null,null,4,"ion-list",[],null,null,null,a.R,a.q)),u.pb(11,49152,null,0,e.M,[u.h,u.k,u.x],null,null),(l()(),u.fb(16777216,null,0,2,null,f)),u.pb(13,278528,null,0,s.j,[u.N,u.J,u.q],{ngForOf:[0,"ngForOf"]},null),u.Eb(131072,s.b,[u.h])],(function(l,n){var t=n.component;l(n,7,0,!t.isTracking),l(n,9,0,t.isTracking),l(n,13,0,u.Jb(n,13,0,u.Cb(n,14).transform(t.locations)))}),(function(l,n){l(n,5,0,n.component.user.uid)}))}function q(l){return u.Kb(0,[u.Eb(0,s.e,[u.s]),u.Gb(671088640,1,{mapElement:0}),(l()(),u.qb(2,0,null,null,6,"ion-header",[],null,null,null,a.I,a.i)),u.pb(3,49152,null,0,e.z,[u.h,u.k,u.x],null,null),(l()(),u.qb(4,0,null,0,4,"ion-toolbar",[],null,null,null,a.Z,a.z)),u.pb(5,49152,null,0,e.xb,[u.h,u.k,u.x],null,null),(l()(),u.qb(6,0,null,0,2,"ion-title",[],null,null,null,a.Y,a.y)),u.pb(7,49152,null,0,e.vb,[u.h,u.k,u.x],null,null),(l()(),u.Ib(-1,0,["TRACKER"])),(l()(),u.qb(9,0,null,null,9,"ion-content",[],null,null,null,a.E,a.e)),u.pb(10,49152,null,0,e.s,[u.h,u.k,u.x],null,null),(l()(),u.qb(11,0,[[1,0],["map",1]],0,0,"div",[["id","map"]],[[8,"hidden",0]],null,null,null,null)),(l()(),u.qb(12,0,null,0,0,"br",[],null,null,null,null,null)),(l()(),u.qb(13,0,null,0,2,"ion-button",[],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.showAlert()&&u),u}),a.B,a.b)),u.pb(14,49152,null,0,e.i,[u.h,u.k,u.x],null,null),(l()(),u.Ib(-1,0,["LOCATION"])),(l()(),u.qb(16,0,null,0,0,"br",[],null,null,null,null,null)),(l()(),u.fb(16777216,null,0,1,null,x)),u.pb(18,16384,null,0,s.k,[u.N,u.J],{ngIf:[0,"ngIf"]},null)],(function(l,n){l(n,18,0,n.component.user)}),(function(l,n){l(n,11,0,!n.component.user)}))}var w=u.mb("ng-component",p,(function(l){return u.Kb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,q,d)),u.pb(1,49152,null,0,p,[h.a,m.a],null,null)],null,null)}),{},{},[]),A=t("iInd");t.d(n,"CompassPageModuleNgFactory",(function(){return I}));var I=u.nb(o,[],(function(l){return u.zb([u.Ab(512,u.j,u.Y,[[8,[i.a,w]],[3,u.j],u.v]),u.Ab(4608,s.m,s.l,[u.s,[2,s.t]]),u.Ab(4608,e.b,e.b,[u.x,u.g]),u.Ab(4608,e.Bb,e.Bb,[e.b,u.j,u.p]),u.Ab(4608,e.Eb,e.Eb,[e.b,u.j,u.p]),u.Ab(1073742336,s.c,s.c,[]),u.Ab(1073742336,e.zb,e.zb,[]),u.Ab(1073742336,A.o,A.o,[[2,A.t],[2,A.m]]),u.Ab(1073742336,o,o,[]),u.Ab(1024,A.k,(function(){return[[{path:"",component:p}]]}),[])])}))}}]);