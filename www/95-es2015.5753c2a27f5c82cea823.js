(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{"3/yS":function(l,n,u){"use strict";u.r(n);var t=u("8Y7J");class o{}var i=u("pMnS"),a=u("MKJQ"),e=u("sZkV"),s=u("SVse"),c=u("gcOT"),b=u("QqCr"),r=u("lJxs");class p{constructor(l,n){this.fbAuth=l,this.afs=n,this.markers=[],this.isTracking=!1,this.user=null,this.anonymousLogin()}ionViewWillEnter(){this.watchPosition().subscribe(l=>this.position=l),this.loadMap()}watchPosition(){return Object(b.a)(c.g.watchPosition)({})}showAlert(){c.h.Modals.alert({title:"Your Location",message:`Lat: ${this.position.coords.latitude}, Lng: ${this.position.coords.longitude}`})}anonymousLogin(){this.fbAuth.auth.signInAnonymously().then(l=>{this.user=l.user,this.locationsCollection=this.afs.collection(`locations/${this.user.uid}/track`,l=>l.orderBy("timestamp")),this.locations=this.locationsCollection.snapshotChanges().pipe(Object(r.a)(l=>l.map(l=>{const n=l.payload.doc.data();return Object.assign({id:l.payload.doc.id},n)}))),this.locations.subscribe(l=>{this.updateMap(l)})})}loadMap(){const l={center:new google.maps.LatLng(51.9036442,7.6673267),zoom:5,mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(this.mapElement.nativeElement,l)}startTracking(){this.isTracking=!0,this.watch=c.g.watchPosition({},(l,n)=>{l&&this.addNewLocation(l.coords.latitude,l.coords.longitude,l.timestamp)})}stopTracking(){c.g.clearWatch({id:this.watch}).then(()=>{this.isTracking=!1})}addNewLocation(l,n,u){this.locationsCollection.add({lat:l,lng:n,timestamp:u});const t=new google.maps.LatLng(l,n);this.map.setCenter(t),this.map.setZoom(5)}deleteLocation(l){this.locationsCollection.doc(l.id).delete()}updateMap(l){this.markers.map(l=>l.setMap(null)),this.markers=[];for(const n of l){const l=new google.maps.LatLng(n.lat,n.lng),u=new google.maps.Marker({map:this.map,animation:google.maps.Animation.DROP,position:l});this.markers.push(u)}}}var h=u("irV9"),m=u("Xr7G"),d=t.ob({encapsulation:0,styles:[["#map[_ngcontent-%COMP%]{width:100%;height:400px}"]],data:{}});function g(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,4,"ion-button",[["expand","block"]],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.startTracking()&&t),t}),a.B,a.b)),t.pb(1,49152,null,0,e.i,[t.h,t.k,t.x],{expand:[0,"expand"]},null),(l()(),t.qb(2,0,null,0,1,"ion-icon",[["name","locate"],["slot","start"]],null,null,null,a.J,a.j)),t.pb(3,49152,null,0,e.A,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.Ib(-1,0,[" Start Tracking "]))],(function(l,n){l(n,1,0,"block"),l(n,3,0,"locate")}),null)}function k(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,4,"ion-button",[["expand","block"]],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.stopTracking()&&t),t}),a.B,a.b)),t.pb(1,49152,null,0,e.i,[t.h,t.k,t.x],{expand:[0,"expand"]},null),(l()(),t.qb(2,0,null,0,1,"ion-icon",[["name","hand"],["slot","start"]],null,null,null,a.J,a.j)),t.pb(3,49152,null,0,e.A,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.Ib(-1,0,[" Stop Tracking "]))],(function(l,n){l(n,1,0,"block"),l(n,3,0,"hand")}),null)}function f(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,15,"ion-item-sliding",[],null,null,null,a.N,a.o)),t.pb(1,49152,null,0,e.K,[t.h,t.k,t.x],null,null),(l()(),t.qb(2,0,null,0,7,"ion-item",[],null,null,null,a.O,a.l)),t.pb(3,49152,null,0,e.F,[t.h,t.k,t.x],null,null),(l()(),t.qb(4,0,null,0,5,"ion-label",[["text-wrap",""]],null,null,null,a.P,a.p)),t.pb(5,49152,null,0,e.L,[t.h,t.k,t.x],null,null),(l()(),t.Ib(6,0,[" Lat: "," Lng: "," "])),(l()(),t.qb(7,0,null,0,2,"p",[],null,null,null,null,null)),(l()(),t.Ib(8,null,[" "," "])),t.Fb(9,2),(l()(),t.qb(10,0,null,0,5,"ion-item-options",[["side","start"]],null,null,null,a.M,a.n)),t.pb(11,49152,null,0,e.J,[t.h,t.k,t.x],{side:[0,"side"]},null),(l()(),t.qb(12,0,null,0,3,"ion-item-option",[["color","danger"]],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.deleteLocation(l.context.$implicit)&&t),t}),a.L,a.m)),t.pb(13,49152,null,0,e.I,[t.h,t.k,t.x],{color:[0,"color"]},null),(l()(),t.qb(14,0,null,0,1,"ion-icon",[["name","trash"],["slot","icon-only"]],null,null,null,a.J,a.j)),t.pb(15,49152,null,0,e.A,[t.h,t.k,t.x],{name:[0,"name"]},null)],(function(l,n){l(n,11,0,"start"),l(n,13,0,"danger"),l(n,15,0,"trash")}),(function(l,n){l(n,6,0,n.context.$implicit.lat,n.context.$implicit.lng);var u=t.Jb(n,8,0,l(n,9,0,t.Cb(n.parent.parent,0),n.context.$implicit.timestamp,"short"));l(n,8,0,u)}))}function x(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,14,"div",[],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,4,"ion-item",[],null,null,null,a.O,a.l)),t.pb(2,49152,null,0,e.F,[t.h,t.k,t.x],null,null),(l()(),t.qb(3,0,null,0,2,"ion-label",[],null,null,null,a.P,a.p)),t.pb(4,49152,null,0,e.L,[t.h,t.k,t.x],null,null),(l()(),t.Ib(5,0,["User ID: ",""])),(l()(),t.fb(16777216,null,null,1,null,g)),t.pb(7,16384,null,0,s.k,[t.N,t.J],{ngIf:[0,"ngIf"]},null),(l()(),t.fb(16777216,null,null,1,null,k)),t.pb(9,16384,null,0,s.k,[t.N,t.J],{ngIf:[0,"ngIf"]},null),(l()(),t.qb(10,0,null,null,4,"ion-list",[],null,null,null,a.R,a.q)),t.pb(11,49152,null,0,e.M,[t.h,t.k,t.x],null,null),(l()(),t.fb(16777216,null,0,2,null,f)),t.pb(13,278528,null,0,s.j,[t.N,t.J,t.q],{ngForOf:[0,"ngForOf"]},null),t.Eb(131072,s.b,[t.h])],(function(l,n){var u=n.component;l(n,7,0,!u.isTracking),l(n,9,0,u.isTracking),l(n,13,0,t.Jb(n,13,0,t.Cb(n,14).transform(u.locations)))}),(function(l,n){l(n,5,0,n.component.user.uid)}))}function q(l){return t.Kb(0,[t.Eb(0,s.e,[t.s]),t.Gb(671088640,1,{mapElement:0}),(l()(),t.qb(2,0,null,null,6,"ion-header",[],null,null,null,a.I,a.i)),t.pb(3,49152,null,0,e.z,[t.h,t.k,t.x],null,null),(l()(),t.qb(4,0,null,0,4,"ion-toolbar",[],null,null,null,a.Z,a.z)),t.pb(5,49152,null,0,e.xb,[t.h,t.k,t.x],null,null),(l()(),t.qb(6,0,null,0,2,"ion-title",[],null,null,null,a.Y,a.y)),t.pb(7,49152,null,0,e.vb,[t.h,t.k,t.x],null,null),(l()(),t.Ib(-1,0,["TRACKER"])),(l()(),t.qb(9,0,null,null,9,"ion-content",[],null,null,null,a.E,a.e)),t.pb(10,49152,null,0,e.s,[t.h,t.k,t.x],null,null),(l()(),t.qb(11,0,[[1,0],["map",1]],0,0,"div",[["id","map"]],[[8,"hidden",0]],null,null,null,null)),(l()(),t.qb(12,0,null,0,0,"br",[],null,null,null,null,null)),(l()(),t.qb(13,0,null,0,2,"ion-button",[],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.showAlert()&&t),t}),a.B,a.b)),t.pb(14,49152,null,0,e.i,[t.h,t.k,t.x],null,null),(l()(),t.Ib(-1,0,["LOCATION"])),(l()(),t.qb(16,0,null,0,0,"br",[],null,null,null,null,null)),(l()(),t.fb(16777216,null,0,1,null,x)),t.pb(18,16384,null,0,s.k,[t.N,t.J],{ngIf:[0,"ngIf"]},null)],(function(l,n){l(n,18,0,n.component.user)}),(function(l,n){l(n,11,0,!n.component.user)}))}function w(l){return t.Kb(0,[(l()(),t.qb(0,0,null,null,1,"ng-component",[],null,null,null,q,d)),t.pb(1,49152,null,0,p,[h.a,m.a],null,null)],null,null)}var A=t.mb("ng-component",p,w,{},{},[]),I=u("iInd");u.d(n,"CompassPageModuleNgFactory",(function(){return L}));var L=t.nb(o,[],(function(l){return t.zb([t.Ab(512,t.j,t.Y,[[8,[i.a,A]],[3,t.j],t.v]),t.Ab(4608,s.m,s.l,[t.s,[2,s.t]]),t.Ab(4608,e.b,e.b,[t.x,t.g]),t.Ab(4608,e.Bb,e.Bb,[e.b,t.j,t.p]),t.Ab(4608,e.Eb,e.Eb,[e.b,t.j,t.p]),t.Ab(1073742336,s.c,s.c,[]),t.Ab(1073742336,e.zb,e.zb,[]),t.Ab(1073742336,I.o,I.o,[[2,I.t],[2,I.m]]),t.Ab(1073742336,o,o,[]),t.Ab(1024,I.k,(function(){return[[{path:"",component:p}]]}),[])])}))}}]);