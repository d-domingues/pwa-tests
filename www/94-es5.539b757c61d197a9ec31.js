(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{Epie:function(l,e,t){"use strict";t.r(e);var n=t("8Y7J");class i{}var o=t("pMnS"),r=t("MKJQ"),u=t("sZkV"),s=t("SVse"),a=t("mrSG"),c=t("gcOT"),h=t("Cfvw"),b=t("LRne"),d=t("cp0P"),p=t("QqCr"),v=t("lJxs"),f=t("5+tZ");let y=(()=>{class l{constructor(l){this.platform=l,this.photos=[],this.PHOTO_STORAGE="photos",this.storedPhotos$=Object(h.a)(c.i.get({key:this.PHOTO_STORAGE})).pipe(Object(v.a)(l=>JSON.parse(l.value)||[]),Object(f.a)(l=>this.isDeviceHybrid?Object(b.a)(l):Object(d.a)(function(l){return l.map(l=>Object(h.a)(c.e.readFile({path:l.filepath,directory:c.f.Data})).pipe(Object(v.a)(e=>Object.assign({},l,{base64:"data:image/jpeg;base64,".concat(e.data)}))))}(l)))),this.convertBlobToBase64=l=>new Promise((e,t)=>{const n=new FileReader;n.onerror=t,n.onload=()=>{e(n.result)},n.readAsDataURL(l)}),this.isDeviceHybrid=this.platform.is("hybrid"),this.storedPhotos$.subscribe(l=>this.photos=l)}watchStore(){return Object(p.a)(c.i.get)({key:this.PHOTO_STORAGE})}addNewToGallery(){return a.__awaiter(this,void 0,void 0,(function*(){const l=yield c.a.getPhoto({resultType:c.b.Uri,source:c.c.Camera,quality:100}),e=yield this.savePicture(l);this.photos.unshift(e),c.i.set({key:this.PHOTO_STORAGE,value:this.isDeviceHybrid?JSON.stringify(this.photos):JSON.stringify(this.photos.map(l=>{const e=Object.assign({},l);return delete e.base64,e}))})}))}savePicture(l){return a.__awaiter(this,void 0,void 0,(function*(){const e=yield this.readAsBase64(l),t=(new Date).getTime()+".jpeg";return yield c.e.writeFile({path:t,data:e,directory:c.f.Data}),yield this.getPhotoFile(l,t)}))}readAsBase64(l){return a.__awaiter(this,void 0,void 0,(function*(){if(this.isDeviceHybrid)return(yield c.e.readFile({path:l.path})).data;const e=yield fetch(l.webPath?l.webPath:null),t=yield e.blob();return yield this.convertBlobToBase64(t)}))}getPhotoFile(l,e){return a.__awaiter(this,void 0,void 0,(function*(){if(this.isDeviceHybrid){const l=yield c.e.getUri({directory:c.f.Data,path:e});return{filepath:l.uri,webviewPath:c.d.convertFileSrc(l.uri)}}return{filepath:e,webviewPath:l.webPath}}))}deletePicture(l,e){return a.__awaiter(this,void 0,void 0,(function*(){this.photos.splice(e,1),c.i.set({key:this.PHOTO_STORAGE,value:JSON.stringify(this.photos)});const t=l.filepath.substr(l.filepath.lastIndexOf("/")+1);yield c.e.deleteFile({path:t,directory:c.f.Data})}))}addNewToGallery1111(){return a.__awaiter(this,void 0,void 0,(function*(){const l=yield c.a.getPhoto({resultType:c.b.Uri,source:c.c.Camera,quality:100}),e=yield this.savePicture(l);this.photos.unshift(e),c.i.set({key:this.PHOTO_STORAGE,value:this.isDeviceHybrid?JSON.stringify(this.photos):JSON.stringify(this.photos.map(l=>{const e=Object.assign({},l);return delete e.base64,e}))})}))}}return l.ngInjectableDef=n.Ob({factory:function(){return new l(n.Pb(u.Db))},token:l,providedIn:"root"}),l})();class O{constructor(l,e){this.photoService=l,this.actionSheetController=e,this.storedPhotos$=this.photoService.storedPhotos$}ngOnInit(){this.photoService.storedPhotos$.subscribe(l=>{console.log(l),this.storedPhotos=l})}showActionSheet(l,e){return a.__awaiter(this,void 0,void 0,(function*(){const t=yield this.actionSheetController.create({header:"Photos",buttons:[{text:"Delete",role:"destructive",icon:"trash",handler:()=>{this.photoService.deletePicture(l,e)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{}}]});yield t.present()}))}}var w=n.ob({encapsulation:0,styles:[[""]],data:{}});function P(l){return n.Kb(0,[(l()(),n.qb(0,0,null,null,3,"ion-col",[["size","3"]],null,null,null,r.D,r.d)),n.pb(1,49152,null,0,u.r,[n.h,n.k,n.x],{size:[0,"size"]},null),(l()(),n.qb(2,0,null,0,1,"ion-img",[],null,[[null,"click"]],(function(l,e,t){var n=!0;return"click"===e&&(n=!1!==l.component.showActionSheet(l.context.$implicit,l.context.index)&&n),n}),r.K,r.k)),n.pb(3,49152,null,0,u.B,[n.h,n.k,n.x],{src:[0,"src"]},null)],(function(l,e){l(e,1,0,"3"),l(e,3,0,n.ub(1,"",e.context.$implicit.base64?e.context.$implicit.base64:e.context.$implicit.webviewPath,""))}),null)}function g(l){return n.Kb(0,[(l()(),n.qb(0,0,null,null,6,"ion-header",[],null,null,null,r.I,r.i)),n.pb(1,49152,null,0,u.z,[n.h,n.k,n.x],null,null),(l()(),n.qb(2,0,null,0,4,"ion-toolbar",[],null,null,null,r.Z,r.z)),n.pb(3,49152,null,0,u.xb,[n.h,n.k,n.x],null,null),(l()(),n.qb(4,0,null,0,2,"ion-title",[],null,null,null,r.Y,r.y)),n.pb(5,49152,null,0,u.vb,[n.h,n.k,n.x],null,null),(l()(),n.Ib(-1,0,[" Photo Gallery "])),(l()(),n.qb(7,0,null,null,20,"ion-content",[],null,null,null,r.E,r.e)),n.pb(8,49152,null,0,u.s,[n.h,n.k,n.x],null,null),(l()(),n.qb(9,0,null,0,6,"ion-header",[["collapse","condense"]],null,null,null,r.I,r.i)),n.pb(10,49152,null,0,u.z,[n.h,n.k,n.x],{collapse:[0,"collapse"]},null),(l()(),n.qb(11,0,null,0,4,"ion-toolbar",[],null,null,null,r.Z,r.z)),n.pb(12,49152,null,0,u.xb,[n.h,n.k,n.x],null,null),(l()(),n.qb(13,0,null,0,2,"ion-title",[["size","large"]],null,null,null,r.Y,r.y)),n.pb(14,49152,null,0,u.vb,[n.h,n.k,n.x],{size:[0,"size"]},null),(l()(),n.Ib(-1,0,["Photo Gallery"])),(l()(),n.qb(16,0,null,0,5,"ion-grid",[],null,null,null,r.H,r.h)),n.pb(17,49152,null,0,u.y,[n.h,n.k,n.x],null,null),(l()(),n.qb(18,0,null,0,3,"ion-row",[],null,null,null,r.W,r.w)),n.pb(19,49152,null,0,u.eb,[n.h,n.k,n.x],null,null),(l()(),n.fb(16777216,null,0,1,null,P)),n.pb(21,278528,null,0,s.j,[n.N,n.J,n.q],{ngForOf:[0,"ngForOf"]},null),(l()(),n.qb(22,0,null,0,5,"ion-fab",[["horizontal","center"],["slot","fixed"],["vertical","bottom"]],null,null,null,r.G,r.f)),n.pb(23,49152,null,0,u.u,[n.h,n.k,n.x],{horizontal:[0,"horizontal"],vertical:[1,"vertical"]},null),(l()(),n.qb(24,0,null,0,3,"ion-fab-button",[],null,[[null,"click"]],(function(l,e,t){var n=!0;return"click"===e&&(n=!1!==l.component.photoService.addNewToGallery()&&n),n}),r.F,r.g)),n.pb(25,49152,null,0,u.v,[n.h,n.k,n.x],null,null),(l()(),n.qb(26,0,null,0,1,"ion-icon",[["name","camera"]],null,null,null,r.J,r.j)),n.pb(27,49152,null,0,u.A,[n.h,n.k,n.x],{name:[0,"name"]},null)],(function(l,e){var t=e.component;l(e,10,0,"condense"),l(e,14,0,"large"),l(e,21,0,t.photoService.photos),l(e,23,0,"center","bottom"),l(e,27,0,"camera")}),null)}var m=n.mb("app-camera",O,(function(l){return n.Kb(0,[(l()(),n.qb(0,0,null,null,1,"app-camera",[],null,null,null,g,w)),n.pb(1,114688,null,0,O,[y,u.a],null,null)],(function(l,e){l(e,1,0)}),null)}),{},{},[]),k=t("iInd");t.d(e,"CameraPageModuleNgFactory",(function(){return x}));var x=n.nb(i,[],(function(l){return n.zb([n.Ab(512,n.j,n.Y,[[8,[o.a,m]],[3,n.j],n.v]),n.Ab(4608,s.m,s.l,[n.s,[2,s.t]]),n.Ab(4608,u.b,u.b,[n.x,n.g]),n.Ab(4608,u.Bb,u.Bb,[u.b,n.j,n.p]),n.Ab(4608,u.Eb,u.Eb,[u.b,n.j,n.p]),n.Ab(1073742336,s.c,s.c,[]),n.Ab(1073742336,u.zb,u.zb,[]),n.Ab(1073742336,k.o,k.o,[[2,k.t],[2,k.m]]),n.Ab(1073742336,i,i,[]),n.Ab(1024,k.k,(function(){return[[{path:"",component:O}]]}),[])])}))}}]);